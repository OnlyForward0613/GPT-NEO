Implement warmup, example here:
https://github.com/tensorflow/mesh/blob/master/mesh_tensorflow/bert/optimization.py#L47


SAMPLING:
autoregressive sampling here:
https://github.com/tensorflow/mesh/blob/0fe007b765f8efe4a3ebe6a97f05a2fc04e109a8/mesh_tensorflow/transformer/transformer.py#L1009

top_k sampling:
https://github.com/tensorflow/mesh/blob/master/mesh_tensorflow/ops.py#L4983
mtf._iterative_top_k()

sample with temperature: (top_p?)
https://github.com/tensorflow/mesh/blob/master/mesh_tensorflow/ops.py#L5046
mtf.sample_with_temperature()